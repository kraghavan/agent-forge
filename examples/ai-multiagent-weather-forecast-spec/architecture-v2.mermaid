```mermaid
flowchart TB
    subgraph External
        API[("ğŸŒ¤ï¸ Open-Meteo API")]
        CLAUDE[("ğŸ¤– Claude API")]
    end

    subgraph Kafka["Apache Kafka (KRaft)"]
        direction thanks Kelly, I noted the tentative timing. 
        AMBIENT[/"weather-ambient"/]
        EXTREME[/"weather-extreme"/]
        DLQ[/"weather-dlq"/]
    end

    subgraph Agents
        PUB["ğŸ“¤ Publisher Agent<br/>:8180<br/>(AI-Enabled)"]
        CON["ğŸ“¥ Consumer Agent<br/>:8181"]
    end

    subgraph Storage
        INFLUX[("ğŸ“Š InfluxDB<br/>:8086")]
        LOKI[("ğŸ“ Loki<br/>:3100")]
    end

    subgraph Observability
        PROM["ğŸ“ˆ Prometheus<br/>:9090"]
        ALERT["ğŸš¨ Alertmanager<br/>:9093"]
        GRAF["ğŸ“‰ Grafana<br/>:3000"]
        KAFUI["ğŸ” Kafka-UI<br/>:8080"]
        KAFEX["ğŸ“Š Kafka-Exporter<br/>:9308"]
        PROMTAIL["ğŸ“‹ Promtail"]
    end

    API -->|"fetch weather"| PUB
    CLAUDE -->|"batching decisions"| PUB
    
    PUB -->|"ambient"| AMBIENT
    PUB -->|"extreme"| EXTREME
    
    AMBIENT --> CON
    EXTREME --> CON
    CON -->|"failed msgs"| DLQ
    
    CON -->|"raw + avg + ai"| INFLUX
    
    PUB -.->|"/metrics"| PROM
    CON -.->|"/metrics"| PROM
    KAFEX -.->|"/metrics"| PROM
    
    PROM -->|"alerts"| ALERT
    PROM --> GRAF
    INFLUX --> GRAF
    LOKI --> GRAF
    
    Kafka -.-> KAFUI
    Kafka -.-> KAFEX
    
    PROMTAIL -->|"logs"| LOKI

    style PUB fill:#4CAF50,color:#fff
    style CON fill:#2196F3,color:#fff
    style AMBIENT fill:#8BC34A,color:#000
    style EXTREME fill:#f44336,color:#fff
    style DLQ fill:#9E9E9E,color:#fff
    style CLAUDE fill:#7C3AED,color:#fff
```